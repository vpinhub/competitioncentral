<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>VPINHUB | Stream Finals Asset</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Encode+Sans:wght@400;700;900&family=MedievalSharp&display=swap" rel="stylesheet">

<style>
html, body {
    margin:0; padding:0;
    width:100%; height:100%;
    background:#020617; color:white;
    font-family:'Encode Sans', sans-serif;
    overflow:hidden;
}

/* ---------- SCOREBOARD TYPE SYSTEM ---------- */
:root{
    --title-size: clamp(48px,5.2vh,110px);
    --section-label: clamp(12px,1.2vh,18px);
    --player-name: clamp(20px,2.2vh,34px);
    --score-size: clamp(22px,2.4vh,38px);
    --rank-size: clamp(26px,2.6vh,42px);
}

.medieval{font-family:'MedievalSharp',cursive;}

.glass{
    background:rgba(255,255,255,0.04);
    backdrop-filter:blur(14px);
    border:1px solid rgba(255,255,255,0.12);
}

.theme-throwdown{--accent:#f97316;}
.theme-swl{--accent:#d946ef;}

.accent-text{color:var(--accent,#94a3b8);}
.accent-border{border-color:var(--accent,#334155);}

#main-stage{
    width:100%; height:100%;
    display:flex; flex-direction:column;
    padding:3vh; box-sizing:border-box;
}

.render-mode{
    width:1920px!important;
    height:1080px!important;
    position:absolute; top:0; left:0;
    z-index:-10; background:#020617!important;
}

/* Medal highlights */
.rank-1{background:linear-gradient(90deg,rgba(255,215,0,0.15),transparent);}
.rank-2{background:linear-gradient(90deg,rgba(192,192,192,0.15),transparent);}
.rank-3{background:linear-gradient(90deg,rgba(205,127,50,0.15),transparent);}

@keyframes scrollLoop{
    0%,15%{transform:translateY(0);}
    85%,100%{transform:translateY(var(--scroll-dist));}
}
.scrolling-content{animation:scrollLoop var(--scroll-speed) ease-in-out infinite alternate;}
</style>
</head>
<body>

<div id="main-stage" class="hidden">

<!-- HEADER -->
<div class="flex justify-between items-end border-b-2 accent-border pb-4 mb-4">
    <div>
        <div class="medieval uppercase accent-text mb-1" style="font-size:var(--section-label)">Final Standings</div>
        <h1 id="table-name" class="font-black italic uppercase leading-tight" style="font-size:var(--title-size)">Table</h1>
    </div>
    <div class="text-right">
        <p id="event-period" class="text-gray-400 font-bold" style="font-size:clamp(14px,1.5vh,22px)"></p>
        <div class="text-[11px] font-black uppercase tracking-widest bg-white/10 px-4 py-1 rounded-full inline-block mt-2">Official Result</div>
    </div>
</div>

<div class="grid grid-cols-12 gap-6 flex-1 overflow-hidden">

    <!-- LEFT PANEL -->
    <div class="col-span-5 flex flex-col gap-4 overflow-hidden">

        <div id="winner-banner"></div>

        <div id="achievements" class="grid grid-cols-2 gap-3"></div>

        <div class="glass rounded-3xl p-6 mt-auto flex justify-around items-center border-t-2 accent-border">
            <div class="text-center">
                <div id="total-players" class="font-black italic" style="font-size:clamp(32px,3vh,50px)">0</div>
                <div class="text-xs uppercase font-bold text-gray-400">Field Size</div>
            </div>
            <div class="text-center">
                <div id="avg-score" class="font-black italic accent-text" style="font-size:clamp(32px,3vh,50px)">0</div>
                <div class="text-xs uppercase font-bold text-gray-400">Average Score</div>
            </div>
        </div>
    </div>

    <!-- LEADERBOARD -->
    <div id="lb-viewport" class="col-span-7 glass rounded-[40px] overflow-hidden relative">
        <div id="leaderboard" class="p-6 flex flex-col gap-2"></div>
    </div>
</div>
</div>

<script>
const AVATAR_BASE="http://vpinhub.github.io/special-when-lit-leaderboard/img/";
const el=id=>document.getElementById(id);

async function loadData(){
    const res=await fetch("json/sample.json"); // change to your file
    const data=await res.json();
    document.body.className=data.competition?.includes('Throwdown')?'theme-throwdown':'theme-swl';
    el('main-stage').classList.remove('hidden');
    renderFinals(data,false);
}

function renderFinals(data,animate){
    const players=data.results||[];
    const a=data.awards||{};
    el('table-name').innerText=data.table;
    el('event-period').innerText=data.period;
    el('total-players').innerText=players.length;
    el('avg-score').innerText=Math.round(players.reduce((s,p)=>s+p.high,0)/players.length).toLocaleString();

    /* WINNER */
    el('winner-banner').innerHTML=`
    <div class="glass p-6 rounded-[32px] border-4 accent-border text-center shadow-xl">
        <div class="medieval accent-text uppercase tracking-widest mb-2" style="font-size:var(--section-label)">Tournament Winner</div>
        <img src="${AVATAR_BASE}${players[0].name.replace(/\s+/g,'_').toLowerCase()}.gif"
             class="w-40 h-40 rounded-full mx-auto mb-3 border-4 accent-border shadow-lg"
             onerror="this.src='https://via.placeholder.com/160?text=?'">
        <div class="font-black italic uppercase" style="font-size:clamp(28px,3vh,50px)">${players[0].name}</div>
        <div class="font-mono font-bold text-gray-300" style="font-size:clamp(22px,2.5vh,40px)">${players[0].high.toLocaleString()}</div>
    </div>`;

    /* LEADERBOARD */
    const lb=el('leaderboard');
    lb.innerHTML=players.map((p,i)=>`
    <div class="flex items-center justify-between px-4 py-3 rounded-xl border border-white/5
        ${i===0?'rank-1':i===1?'rank-2':i===2?'rank-3':'bg-white/5'}">
        <div class="flex items-center gap-4">
            <span style="font-size:var(--rank-size)" class="font-black italic w-10 text-center ${i<3?'accent-text':'text-gray-600'}">${i+1}</span>
            <img src="${AVATAR_BASE}${p.name.replace(/\s+/g,'_').toLowerCase()}.gif"
                 class="w-12 h-12 rounded-full border border-white/10"
                 onerror="this.src='https://via.placeholder.com/48?text=?'">
            <span class="font-bold uppercase tracking-wide" style="font-size:var(--player-name)">${p.name}</span>
        </div>
        <span class="font-mono font-black accent-text" style="font-size:var(--score-size)">${p.high.toLocaleString()}</span>
    </div>`).join('');

    setTimeout(()=>{
        const vh=el('lb-viewport').offsetHeight;
        const ch=lb.scrollHeight;
        if(ch>vh){
            const scale=Math.max(0.82,(vh-10)/ch);
            lb.style.transform=`scale(${scale})`;
            lb.style.transformOrigin='top center';
        }
    },150);
}

loadData();
</script>
</body>
</html>
